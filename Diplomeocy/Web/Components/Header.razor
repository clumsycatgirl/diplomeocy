@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

@* <header>
<nav class="bg-[#172554] border-b border-sky-900 shadow mb-3">
<div class="container mx-auto px-4">
<div class="flex justify-between items-center">
<a class="text-black text-lg font-bold" asp-area="" asp-controller="Home" asp-action="Index">Web</a>
<button class="navbar-toggler block sm:hidden text-black" type="button" data-bs-toggle="collapse"
data-bs-target="#navbarNav" aria-controls="navbarNav"
aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="navbar-collapse collapse sm:flex sm:items-center" id="navbarNav">
<ul class="navbar-nav flex flex-col sm:flex-row sm:ml-auto">
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
</li>
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Users" asp-action="LogIn">Log In</a>
</li>
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Users" asp-action="Create">Sign Up</a>
</li>
@if (user is not null) {
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Tables" asp-action="Create">New Game</a>
</li>
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Players" asp-action="Create">Join Game</a>
</li>
}
<li class="nav-item">
<a class="nav-link text-black hover:text-sky-300" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
</li>
</ul>
</div>
</div>
</div>
</nav>
</header> *@

<style>
    .transition-all {
        transition: all 0.3s ease-in-out;
    }
    .hidden-container {
		position: absolute;
        transform: translateX(100%);
        overflow: hidden;
		opacity: 0;
    }
    .visible-container {
		position: relative;
        transform: translateX(0);
        opacity: 1;
    }
</style>

<!-- ========== HEADER ========== -->
<header class="flex flex-wrap sm:justify-start sm:flex-nowrap z-50 w-full text-sm sm:py-0">
    <nav class="relative w-full mx-auto px-4 sm:flex sm:items-center sm:justify-between sm:px-6 lg:px-8"
         aria-label="Global">
        <div class="flex items-center justify-between">
            <a class="flex-none text-xl font-semibold dark:text-white" style="font-family: 'Lobster', cursive;" href="/"
               aria-label="Diplomeocy">
                <div>
                    <img src="/assets/images/logo-gold.svg" class="w-32 h-auto" />
                </div>
            </a>
            <div class="sm:hidden">
                <button type="button"
                        class="hs-collapse-toggle size-9 flex justify-center items-center text-sm font-semibold rounded-lg border border-gray-200 text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none dark:text-white dark:border-neutral-700 dark:hover:bg-neutral-700"
                        data-hs-collapse="#navbar-collapse-with-animation" aria-controls="navbar-collapse-with-animation"
                        aria-label="Toggle navigation">
                    <svg class="hs-collapse-open:hidden flex-shrink-0 size-4" width="16" height="16" fill="currentColor"
                         viewBox="0 0 16 16">
                        <path fill-rule="evenodd"
                              d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                    </svg>
                    <svg class="hs-collapse-open:block flex-shrink-0 hidden size-4" width="16" height="16" fill="currentColor"
                         viewBox="0 0 16 16">
                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                    </svg>
                </button>
            </div>
        </div>
        <div id="navbar-collapse-with-animation"
             class="hs-collapse hidden overflow-hidden transition-all duration-300 basis-full grow sm:block">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-end md:py-0 sm:ps-7">
                <a class="py-3 ps-px sm:px-3 font-medium text-gray-500 hover:text-gray-400 dark:text-neutral-400 dark:hover:text-neutral-500"
                   href="/">Home</a>
                <a class="py-3 ps-px sm:px-3 font-medium text-gray-500 hover:text-gray-400 dark:text-neutral-400 dark:hover:text-neutral-500"
                   href="/Rulebook">Rulebook</a>
                <a class="py-3 ps-px sm:px-3 font-medium text-gray-500 hover:text-gray-400 dark:text-neutral-400 dark:hover:text-neutral-500"
                   href="/TermsOfServices">Terms of services</a>
                <a class="py-3 ps-px sm:px-3 font-medium text-gray-500 hover:text-gray-400 dark:text-neutral-400 dark:hover:text-neutral-500"
                   href="/Privacy">Privacy</a>
                <a class="py-3 ps-px sm:px-3 font-medium text-gray-500 hover:text-gray-400 dark:text-neutral-400 dark:hover:text-neutral-500"
                   href="/Documentation">Documentation</a>

                <div class="ml-3 mr-6">
                    <button type="button"
                            class="hs-dark-mode-active:hidden block hs-dark-mode group flex items-center text-gray-600 hover:text-blue-600 font-medium dark:text-gray-400 dark:hover:text-gray-500"
                            onclick="document.querySelector('html').className = 'dark'" hx-trigger="click" hx-get="/theme?theme=dark"
                            hx-swap="none">
                        <svg class="flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                             stroke-linejoin="round">
                            <circle cx="12" cy="12" r="4" />
                            <path d="M12 8a2 2 0 1 0 4 4" />
                            <path d="M12 2v2" />
                            <path d="M12 20v2" />
                            <path d="m4.93 4.93 1.41 1.41" />
                            <path d="m17.66 17.66 1.41 1.41" />
                            <path d="M2 12h2" />
                            <path d="M20 12h2" />
                            <path d="m6.34 17.66-1.41 1.41" />
                            <path d="m19.07 4.93-1.41 1.41" />
                        </svg>
                    </button>
                    <button type="button"
                            class="hs-dark-mode-active:block hidden hs-dark-mode group flex items-center text-gray-600 hover:text-blue-600 font-medium dark:text-gray-400 dark:hover:text-gray-500"
                            onclick="document.querySelector('html').className = 'light'" hx-trigger="click" hx-get="/theme?theme=light"
                            hx-swap="none">
                        <svg class=" flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                             stroke-linejoin="round">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />
                        </svg>
                    </button>
                </div>

                <a class="flex items-center gap-x-2 font-semibold text-gray-500 hover:text-blue-600 sm:border-s sm:border-gray-300 sm:py-0 sm:my-6 sm:ps-6 dark:border-neutral-700 dark:text-neutral-400 dark:hover:text-blue-500"
                   href="@GetLogSignHref()">
                    <svg class="flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                        <circle cx="12" cy="7" r="4" />
                    </svg>
                    @GetLogSignText()
                </a>
            </div>
        </div>
    </nav>
</header>
<!-- ========== END HEADER ========== -->
<!-- Nav -->
@if (IsLoggedIn) {
    <nav class="mx-auto px-4 sm:px-6 lg:px-8">
        <div class="relative flex flex-row justify-between items-center gap-x-8 border-t sm:py-0 sm:border-gray-300 dark:border-neutral-700">
            <div class="flex items-center sm:w-[auto] w-full">
                @* <span class="font-semibold whitespace-nowrap text-gray-800 border-e border-e-white/70 sm:border-transparent
            pe-4 me-4 sm:py-3.5 dark:text-white">Meow!!! :3</span> *@
            </div>

            <div id="secondary-nav-toggle"
                 class="hs-collapse hidden overflow-hidden transition-all duration-300 absolute top-16 end-0 w-full rounded-lg sm:block sm:static sm:top-0 sm:w-full sm:max-h-full sm:bg-transparent sm:overflow-visible">
                <div class="flex flex-col py-2 sm:flex-row sm:justify-end sm:gap-y-0 sm:gap-x-6 sm:py-0">
                    @* <a class="text-sm font-medium text-gray-800 hover:text-blue-600 sm:border-b-2 border-b-transparent py-2 sm:py-3.5 dark:text-neutral-400 dark:hover:text-white"
                href="/Users/Details">Account</a> *@
					<div class="hidden translate-x-[-300%] translate-x-[-560%] translate-x-[-50%] translate-x-[-200%] opacity-0"></div>
                    <a class="text-sm font-medium text-gray-800 hover:text-blue-600 sm:border-b-2 border-b-transparent py-2 mt-2 sm:py-3.5 dark:text-neutral-400 dark:hover:text-white absolute translate-x-[-300%] transition-all"
                       href="/Users/Tables" id="my-tables-link">My Tables</a>
                    <a class="text-sm font-medium text-gray-800 hover:text-blue-600 sm:border-b-2 border-b-transparent py-2 mt-2 sm:py-3.5 dark:text-neutral-400 dark:hover:text-white absolute translate-x-[-50%] transition-all"
                       href="/Tables/Create" id="create-table-link">Create New Table</a>
                    <a class="text-sm font-medium text-gray-800 hover:text-blue-600 sm:border-b-2 border-b-transparent py-2 mt-2 sm:py-3.5 dark:text-neutral-400 dark:hover:text-white transition-all"
                       href="javascript:void(0)" id="join-link">Join</a>
                    <div class="hidden-container flex py-2 sm:py-3.5 transition-all ease-in-out" id="join-input-container">
                        <div class="relative">
                            <div class="absolute inset-y-0 start-0 flex items-center pointer-events-none z-20 ps-4">
                                <svg class="flex-shrink-0 size-4 text-sm font-medium text-gray-800 hover:text-blue-600 dark:text-neutral-400 dark:hover:text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>
                            </div>
                            <input type="text" id="join-input" class="py-2 px-4 ps-11 pe-20 block w-44 md:w-44 bg-transparent border-gray-700 shadow-sm rounded-lg text-sm text-gray-800 focus:z-10 focus:border-primary-900 focus:ring-primary-600 placeholder:text-gray-500 dark:border-neutral-700 dark:text-neutral-500 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" placeholder="123456">
                        </div>
                        <div class="absolute inset-y-0 end-0 flex items-center z-20 pe-4 transition-all">
                            <button id="join-submit-button" class="text-sm font-medium text-gray-800 hover:text-blue-600 dark:text-neutral-400 dark:hover:text-white">Join</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
}
<!-- End Nav -->
@code {
    public User? User = new();

    public String Theme = "light";

    protected override void OnInitialized() {
        base.OnInitialized();
        User = HttpContextAccessor.HttpContext?.Session.Get<User>("User");

        byte[]? theme = HttpContextAccessor.HttpContext?.Session.Get("Theme");
        Theme = theme is not null ? System.Text.Encoding.UTF8.GetString(theme) : "light";

        Debug.WriteLine($"User: {User}");
    }

    public string GetLogSignHref() => !IsLoggedIn ? "/Auth" : "/Users/LogOut";
    public string GetLogSignText() => !IsLoggedIn ? "Log In" : "Log Out";

    public bool IsLoggedIn => User is not null;
}
